<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Reference | DyGram</title>
    <link rel="stylesheet" href="static/styles/main.css">
    <script src="https://unpkg.com/monaco-editor@latest/min/vs/loader.js"></script>
</head>
<body>
    <header style="height: auto; padding: 4rem 0;">
        <div class="container">
            <a href="index.html" style="color: var(--primary); text-decoration: none; font-size: 1.2rem;">‚Üê Back to Home</a>
            <div class="title-block" style="margin-top: 2rem;">
                API Reference<span class="accent">.</span>
            </div>
        </div>
    </header>

    <section>
        <div class="container">
            <h2 class="section-title">Programmatic API</h2>
            <p style="font-size: 1.2rem; margin-bottom: 3rem;">
                Use DyGram as a library in your Node.js applications.
            </p>

            <div class="feature" style="margin-bottom: 3rem;">
                <h3 class="feature-title">INSTALLATION</h3>
                <div class="code-block" style="margin-top: 1rem;">
                    <pre style="background: var(--code-bg); color: var(--light); padding: 1.5rem; overflow-x: auto; border-radius: 4px;">npm install dygram</pre>
                </div>
            </div>

            <div class="feature" style="margin-bottom: 3rem;">
                <h3 class="feature-title">PARSING</h3>
                <p>Parse DyGram source code into an Abstract Syntax Tree (AST):</p>
                <div class="code-block" style="margin-top: 1rem;">
                    <pre style="background: var(--code-bg); color: var(--light); padding: 1.5rem; overflow-x: auto; border-radius: 4px; font-size: 0.95rem;"><span style="color: #569cd6;">import</span> { <span style="color: #9cdcfe;">createMachineServices</span> } <span style="color: #569cd6;">from</span> <span style="color: #ce9178;">'dygram'</span>;
<span style="color: #569cd6;">import</span> { <span style="color: #9cdcfe;">EmptyFileSystem</span> } <span style="color: #569cd6;">from</span> <span style="color: #ce9178;">'langium'</span>;

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">services</span> = <span style="color: #dcdcaa;">createMachineServices</span>(<span style="color: #9cdcfe;">EmptyFileSystem</span>);
<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">parser</span> = <span style="color: #9cdcfe;">services</span>.<span style="color: #9cdcfe;">Machine</span>.<span style="color: #9cdcfe;">parser</span>.<span style="color: #9cdcfe;">LangiumParser</span>;

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">code</span> = <span style="color: #ce9178;">`machine "Example"
  state a;
  state b;
  a -> b;`</span>;

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">result</span> = <span style="color: #9cdcfe;">parser</span>.<span style="color: #dcdcaa;">parse</span>(<span style="color: #9cdcfe;">code</span>);

<span style="color: #c586c0;">if</span> (<span style="color: #9cdcfe;">result</span>.<span style="color: #9cdcfe;">lexerErrors</span>.<span style="color: #9cdcfe;">length</span> === <span style="color: #b5cea8;">0</span> &&
    <span style="color: #9cdcfe;">result</span>.<span style="color: #9cdcfe;">parserErrors</span>.<span style="color: #9cdcfe;">length</span> === <span style="color: #b5cea8;">0</span>) {
  <span style="color: #9cdcfe;">console</span>.<span style="color: #dcdcaa;">log</span>(<span style="color: #ce9178;">'Parsed successfully!'</span>);
  <span style="color: #9cdcfe;">console</span>.<span style="color: #dcdcaa;">log</span>(<span style="color: #9cdcfe;">result</span>.<span style="color: #9cdcfe;">value</span>);
}</pre>
                </div>
            </div>

            <div class="feature" style="margin-bottom: 3rem;">
                <h3 class="feature-title">CONTEXT MANAGEMENT</h3>
                <p>Execute machines with enhanced context value management:</p>
                <div class="code-block" style="margin-top: 1rem;">
                    <pre style="background: var(--code-bg); color: var(--light); padding: 1.5rem; overflow-x: auto; border-radius: 4px; font-size: 0.95rem;"><span style="color: #569cd6;">import</span> { <span style="color: #9cdcfe;">MachineExecutor</span> } <span style="color: #569cd6;">from</span> <span style="color: #ce9178;">'dygram'</span>;

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">machineData</span> = {
  <span style="color: #9cdcfe;">title</span>: <span style="color: #ce9178;">"Context Demo"</span>,
  <span style="color: #9cdcfe;">nodes</span>: [
    { <span style="color: #9cdcfe;">name</span>: <span style="color: #ce9178;">"start"</span>, <span style="color: #9cdcfe;">type</span>: <span style="color: #ce9178;">"state"</span> },
    { <span style="color: #9cdcfe;">name</span>: <span style="color: #ce9178;">"process"</span>, <span style="color: #9cdcfe;">type</span>: <span style="color: #ce9178;">"Task"</span>, <span style="color: #9cdcfe;">attributes</span>: [
      { <span style="color: #9cdcfe;">name</span>: <span style="color: #ce9178;">"meta"</span>, <span style="color: #9cdcfe;">value</span>: <span style="color: #ce9178;">"true"</span> },
      { <span style="color: #9cdcfe;">name</span>: <span style="color: #ce9178;">"prompt"</span>, <span style="color: #9cdcfe;">value</span>: <span style="color: #ce9178;">"Generate data and store using set_context_value"</span> }
    ]},
    { <span style="color: #9cdcfe;">name</span>: <span style="color: #ce9178;">"output"</span>, <span style="color: #9cdcfe;">type</span>: <span style="color: #ce9178;">"context"</span>, <span style="color: #9cdcfe;">attributes</span>: [
      { <span style="color: #9cdcfe;">name</span>: <span style="color: #ce9178;">"result"</span>, <span style="color: #9cdcfe;">type</span>: <span style="color: #ce9178;">"string"</span>, <span style="color: #9cdcfe;">value</span>: <span style="color: #ce9178;">""</span> }
    ]}
  ],
  <span style="color: #9cdcfe;">edges</span>: [
    { <span style="color: #9cdcfe;">source</span>: <span style="color: #ce9178;">"start"</span>, <span style="color: #9cdcfe;">target</span>: <span style="color: #ce9178;">"process"</span> },
    { <span style="color: #9cdcfe;">source</span>: <span style="color: #ce9178;">"process"</span>, <span style="color: #9cdcfe;">target</span>: <span style="color: #ce9178;">"output"</span> }
  ]
};

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">config</span> = {
  <span style="color: #9cdcfe;">llm</span>: {
    <span style="color: #9cdcfe;">provider</span>: <span style="color: #ce9178;">'anthropic'</span>,
    <span style="color: #9cdcfe;">apiKey</span>: <span style="color: #9cdcfe;">process</span>.<span style="color: #9cdcfe;">env</span>.<span style="color: #9cdcfe;">ANTHROPIC_API_KEY</span>,
    <span style="color: #9cdcfe;">model</span>: <span style="color: #ce9178;">'claude-3-5-sonnet-20241022'</span>
  }
};

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">executor</span> = <span style="color: #c586c0;">await</span> <span style="color: #9cdcfe;">MachineExecutor</span>.<span style="color: #dcdcaa;">create</span>(<span style="color: #9cdcfe;">machineData</span>, <span style="color: #9cdcfe;">config</span>);
<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">result</span> = <span style="color: #c586c0;">await</span> <span style="color: #9cdcfe;">executor</span>.<span style="color: #dcdcaa;">execute</span>();</pre>
                </div>
            </div>

            <div class="feature" style="margin-bottom: 3rem;">
                <h3 class="feature-title">VALIDATION</h3>
                <p>Validate DyGram code and get diagnostic messages:</p>
                <div class="code-block" style="margin-top: 1rem;">
                    <pre style="background: var(--code-bg); color: var(--light); padding: 1.5rem; overflow-x: auto; border-radius: 4px; font-size: 0.95rem;"><span style="color: #569cd6;">import</span> { <span style="color: #9cdcfe;">createMachineServices</span> } <span style="color: #569cd6;">from</span> <span style="color: #ce9178;">'dygram'</span>;
<span style="color: #569cd6;">import</span> { <span style="color: #9cdcfe;">EmptyFileSystem</span> } <span style="color: #569cd6;">from</span> <span style="color: #ce9178;">'langium'</span>;

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">services</span> = <span style="color: #dcdcaa;">createMachineServices</span>(<span style="color: #9cdcfe;">EmptyFileSystem</span>);
<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">validator</span> = <span style="color: #9cdcfe;">services</span>.<span style="color: #9cdcfe;">Machine</span>.<span style="color: #9cdcfe;">validation</span>.<span style="color: #9cdcfe;">DocumentValidator</span>;

<span style="color: #6a9955;">// Parse and validate</span>
<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">document</span> = <span style="color: #c586c0;">await</span> <span style="color: #9cdcfe;">services</span>.<span style="color: #9cdcfe;">shared</span>.<span style="color: #9cdcfe;">workspace</span>
  .<span style="color: #9cdcfe;">LangiumDocuments</span>.<span style="color: #dcdcaa;">getOrCreateDocument</span>(<span style="color: #9cdcfe;">uri</span>, <span style="color: #9cdcfe;">code</span>);

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">diagnostics</span> = <span style="color: #c586c0;">await</span> <span style="color: #9cdcfe;">validator</span>.<span style="color: #dcdcaa;">validateDocument</span>(<span style="color: #9cdcfe;">document</span>);

<span style="color: #9cdcfe;">diagnostics</span>.<span style="color: #dcdcaa;">forEach</span>(<span style="color: #9cdcfe;">diag</span> <span style="color: #569cd6;">=></span> {
  <span style="color: #9cdcfe;">console</span>.<span style="color: #dcdcaa;">log</span>(<span style="color: #ce9178;">`</span><span style="color: #569cd6;">${</span><span style="color: #9cdcfe;">diag</span>.<span style="color: #9cdcfe;">severity</span><span style="color: #569cd6;">}</span><span style="color: #ce9178;">: </span><span style="color: #569cd6;">${</span><span style="color: #9cdcfe;">diag</span>.<span style="color: #9cdcfe;">message</span><span style="color: #569cd6;">}</span><span style="color: #ce9178;">`</span>);
});</pre>
                </div>
            </div>

            <div class="feature" style="margin-bottom: 3rem;">
                <h3 class="feature-title">DIAGRAM GENERATION</h3>
                <p>Generate Mermaid diagrams from DyGram code:</p>
                <div class="code-block" style="margin-top: 1rem;">
                    <pre style="background: var(--code-bg); color: var(--light); padding: 1.5rem; overflow-x: auto; border-radius: 4px; font-size: 0.95rem;"><span style="color: #569cd6;">import</span> { <span style="color: #9cdcfe;">generateMermaid</span> } <span style="color: #569cd6;">from</span> <span style="color: #ce9178;">'dygram/cli'</span>;

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">code</span> = <span style="color: #ce9178;">`machine "Flow"
  state start;
  state end;
  start -> end;`</span>;

<span style="color: #569cd6;">const</span> <span style="color: #9cdcfe;">mermaid</span> = <span style="color: #dcdcaa;">generateMermaid</span>(<span style="color: #9cdcfe;">code</span>);
<span style="color: #9cdcfe;">console</span>.<span style="color: #dcdcaa;">log</span>(<span style="color: #9cdcfe;">mermaid</span>);

<span style="color: #6a9955;">// Output:</span>
<span style="color: #6a9955;">// graph TD</span>
<span style="color: #6a9955;">//   start --> end</span></pre>
                </div>
            </div>

            <div style="margin-top: 4rem;">
                <h2 class="section-title" style="font-size: 2rem;">CLI Commands</h2>
                <p style="font-size: 1.2rem; margin-bottom: 2rem;">
                    DyGram provides a command-line interface:
                </p>

                <div class="feature-grid">
                    <div class="feature">
                        <h3 class="feature-title">EXECUTE</h3>
                        <div class="code-block">
                            <pre style="background: var(--code-bg); color: var(--light); padding: 1rem; overflow-x: auto; border-radius: 4px; font-size: 0.9rem;">npx dygram file.mach</pre>
                        </div>
                        <p style="margin-top: 0.5rem;">Execute a DyGram file</p>
                    </div>

                    <div class="feature">
                        <h3 class="feature-title">VALIDATE</h3>
                        <div class="code-block">
                            <pre style="background: var(--code-bg); color: var(--light); padding: 1rem; overflow-x: auto; border-radius: 4px; font-size: 0.9rem;">npx dygram validate file.mach</pre>
                        </div>
                        <p style="margin-top: 0.5rem;">Check syntax and semantics</p>
                    </div>

                    <div class="feature">
                        <h3 class="feature-title">EXPORT</h3>
                        <div class="code-block">
                            <pre style="background: var(--code-bg); color: var(--light); padding: 1rem; overflow-x: auto; border-radius: 4px; font-size: 0.9rem;">npx dygram export --format mermaid file.mach</pre>
                        </div>
                        <p style="margin-top: 0.5rem;">Generate diagrams and documentation</p>
                    </div>
                </div>
            </div>

            <div style="margin-top: 4rem;">
                <h2 class="section-title" style="font-size: 2rem;">TypeScript Support</h2>
                <p style="font-size: 1.2rem; margin-bottom: 1rem;">
                    DyGram is written in TypeScript and provides full type definitions for all APIs.
                </p>
                <p style="font-size: 1.2rem;">
                    See the <a href="https://github.com/christopherdebeer/machine" style="color: var(--accent); text-decoration: none;">GitHub repository</a> for detailed type information and source code.
                </p>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-links">
                    <h3>DOCUMENTATION</h3>
                    <ul>
                        <li><a href="quick-start.html">Quick Start</a></li>
                        <li><a href="grammar-reference.html">Grammar Reference</a></li>
                        <li><a href="examples.html">Examples</a></li>
                        <li><a href="integration.html">Integration</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h3>RESOURCES</h3>
                    <ul>
                        <li><a href="https://github.com/christopherdebeer/machine" target="_blank">GitHub</a></li>
                        <li><a href="vscode-extension.html">VS Code Extension</a></li>
                        <li><a href="api.html">API</a></li>
                        <li><a href="libraries.html">Libraries</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h3>COMMUNITY</h3>
                    <ul>
                        <li><a href="#">Discord</a></li>
                        <li><a href="#">Twitter</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="events.html">Events</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                &copy; 2025 DyGram. All rights reserved.
            </div>
        </div>
    </footer>

</script>
</body>
</html>
